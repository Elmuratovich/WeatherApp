<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
 integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="../animation.css">
    <title>Home Page</title>
  </head>
  <body>
    <header>
        <div class="d-flex flex-column flex-md-row align-items-center pb-3 mb-4 border-bottom">
        <a href="/" class="d-flex align-items-center text-dark text-decoration-none">
            <svg xmlns="" width="40" height="32" class="me-2" viewBox="0 0 118 94" role=""><path fill-rule="evenodd" clip-rule="evenodd" d="" fill="currentColor"></path></svg>
            <span class="fs-4">
                <div class="sign">
                  <span class="fast-flicker">W</span>eat<span class="flicker">h</span>er
                </div>
            </span>
        </a>

        <nav class="d-inline-flex mt-2 mt-md-0 ms-md-auto">
            <a class="me-3 py-2 text-light text-decoration-none" href="/">Home</a>
            <a class="me-3 py-2 text-light text-decoration-none" href="/Login">Login</a>
            <a class="me-3 py-2 text-light text-decoration-none" href="/Register">Register</a>
        </nav>
        </div>
    </header>

    <div class="row">
      <div class="col-12 col-sm-6 col-md-6">
          <div class="app-wrap">
              <main>
                <input id="city1" type="text" class="search-box" placeholder="search...">
                  <section class="location">
                      <div id="demo" class="city">Egypt, US</div>
                      <div class="data">Monday 8 June 2021</div>
                  </section>
                  <div class="main-temp">
                      <div class="temp">8<span>°c</span></div>
                      <div class="weather">Fog</div>
                      <div class="hi-low">19°c / 23°c</div>
                  </div>
                  <div class="week">
                    <div class="d-flex justify-content-around align-items-center mb-3">
                      <div class="flex-column ">
                        <p class="small mb-1" id="day1">Sun</p>
                        <p class="small mb-0" id="day1Min"><strong>-4°C</strong></p>
                      </div>
                     
                      <div class="flex-column">
                        <p class="small mb-1" id="day2">Mon</p>
                        <p class="small mb-0" id="day2Min"><strong>-4°C</strong>
                      </div>
                      
                      <div class="flex-column ">
                        <p class="small mb-1" id="day3">Tue</p>
                        <p class="small mb-0" id="day3Min"><strong>-4°C</strong>
                      </div>
                      
                      <div class="flex-column ">
                        <p class="small mb-1" id="day4">Wed</p>
                        <p class="small mb-0" id="day4Min"><strong>-4°C</strong>
                      </div>
                      
                      <div class="flex-column ">
                        <p class="small mb-1" id="day5">Thu</p>
                        <p class="small mb-0" id="day5Min"><strong>-4°C</strong>
                      </div>
                      
                      <div class="flex-column">
                        <p class="small mb-1" id="day6">Fri</p>
                        <p class="small mb-0" id="day6Min"><strong>-4°C</strong>
                      </div>
                      
                      <div class="flex-column ">
                        <p class="small mb-1" id="day7">Sat</p>
                        <p class="small mb-0" id="day7Min"><strong>-4°C</strong>
                      </div>
                      
                    </div>
                  </div>
              </main>
          </div>
      </div>
      <div class="col-12 col-sm-6 col-md-6">
        
        <a href="/" class="d-flex align-items-center text-dark text-decoration-none">
            <svg xmlns="" width="40" height="32" class="me-2" viewBox="0 0 118 94" role=""><path fill-rule="evenodd" clip-rule="evenodd" d="" fill="currentColor"></path></svg>
            <span class="fs-4">
                <div class="sign" style="text-align: center;">
                  <span class="fast-flicker">N</span>E<span class="flicker">W</span>S
                </div>
            </span>
        </a>

        <div class="container my-3">
          
          <hr>
          <div class="accordion" id="newsAccordion"></div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>



    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
    crossorigin="anonymous"></script>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
    integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
    crossorigin="anonymous"></script>



    <script>
      const api = {
        key: '7395f721041dbe957e1115109b0c950a',
        baseurl:'https://api.openweathermap.org/data/2.5/',
      }

      function myFunction() {
          const searchBox = document.querySelector(".search-box");
          let city = document.querySelector(".city");
          city.innerHTML = "Accepted!!!";
      }

      const searchBox = document.querySelector(".search-box");

      searchBox.addEventListener("keypress", setQuery);

      function setQuery(e){
          if(e.keyCode == 13) {
              
              getResults(searchBox.value);
              console.log(searchBox.value);
          }
      }

      function  getResults(query) {
          fetch(`${api.baseurl}weather?q=${query}&units=metric&APPID=${api.key}`)
              .then((weather) => {
                  return weather.json();
              })
              .then(displayResults);
      }

      function displayResults(weather) {
          console.log(weather);
          let city = document.querySelector(".location .city");
          city.innerHTML = `${weather.name}, ${weather.sys.country}`;

          let temp = document.querySelector(".temp");
          temp.innerHTML = `${Math.round(weather.main.temp_min)}<span>°c</span>`;

          let weatherE1 = document.querySelector(".weather");
          weatherE1.innerHTML = weather.weather[0].main;

          let hilow = document.querySelector(".hi-low");
          hilow.innerHTML = `${Math.round(weather.main.temp_min)}°c / ${Math.round(weather.main.temp_max)}°c`;

          fetch('https://api.openweathermap.org/data/2.5/forecast?q='+searchBox.value+'&appid=7395f721041dbe957e1115109b0c950a')
          .then(response => response.json())
          .then(data => {

              
              for(i = 0; i<7; i++){
                  document.getElementById("day" + (i+1) + "Min").innerHTML = Number(data.list[i].main.temp_max - 273.15).toFixed(1)+ "°";
              }
              console.log(data)


          })

        
      }



      

      var d = new Date();
      var weekday = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",];


      function CheckDay(day){
        if(day + d.getDay() >=7){
            return day + d.getDay() - 7;
        }
        else{
            return day + d.getDay();
        }
      }

      for(i = 0; i<7; i++){
        document.getElementById("day" + (i+1)).innerHTML = weekday[CheckDay(i+1)];
      }


      //===================================================================================

      console.log("This is my index js file");

        // Initialize the news api parameters
        let source = 'the-times-of-india';
        let apiKey = 'aa0725fd53fd4bc387de20bb37403765'

        // Grab the news container
        let newsAccordion = document.getElementById('newsAccordion');

        // Create an ajax get request
        const xhr = new XMLHttpRequest();
        //xhr.open('GET', `https://newsapi.org/v2/top-headlines?sources=${source}&apiKey=${apiKey}`, true);
        xhr.open('GET', `https://newsapi.org/v2/top-headlines?country=us&apiKey=aa0725fd53fd4bc387de20bb37403765`, true);

        // What to do when response is ready
        xhr.onload = function () {
            if (this.status === 200) {
                let json = JSON.parse(this.responseText);
                let articles = json.articles;
                console.log(articles);
                let newsHtml = "";
                articles.forEach(function(element, index) {
                    // console.log(element, index)
                    let news = `<div class="card">
                                    <div class="card-header" id="heading${index}">
                                        <h2 class="mb-0">
                                        <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapse${index}"
                                            aria-expanded="false" aria-controls="collapse${index}">
                                          <b>Breaking News ${index+1}:</b> ${element["title"]}
                                        </button>
                                        </h2>
                                    </div>

                                    <div id="collapse${index}" class="collapse" aria-labelledby="heading${index}" data-parent="#newsAccordion">
                                        <div class="card-body"> ${element["content"]}. <a href="${element['url']}" target="_blank" >Read more here</a>  </div>
                                    </div>
                                </div>`;
                    newsHtml += news;
                });
                newsAccordion.innerHTML = newsHtml;
            }
            else {
                console.log("Some error occured")
            }
        }

        xhr.send()





    </script>
  </body>
</html>
